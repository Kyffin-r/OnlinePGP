<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OnlinePGP</title>
    <link rel="shortcut icon" href="favicon.png" type="image/png">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/openpgp/4.0.1/openpgp.min.js" crossorigin="anonymous"></script>
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background: #121212;
            color: #e0e0e0;
            margin: 0;
            padding: 0;
            display: flex;
            height: 100vh;
        }
        .sidebar {
            background: #1c1c1c;
            padding: 1rem;
            width: 250px;
            height: 100vh;
            overflow-y: auto;
        }
        .sidebar button {
            display: block;
            background: none;
            border: none;
            color: #e0e0e0;
            padding: 10px 0;
            text-align: left;
            width: 100%;
            cursor: pointer;
        }
        .sidebar button:hover {
            background: #333;
        }
        .content {
            flex: 1;
            padding: 2rem;
            overflow-y: auto;
        }
        section {
            display: none;
        }
        section.active {
            display: block;
        }
        textarea, input {
            width: 100%;
            margin-bottom: 1rem;
            padding: 0.5rem;
            background: #2c2c2c;
            border: 1px solid #3c3c3c;
            color: #e0e0e0;
            border-radius: 4px;
        }
        .btn {
            background: #1e88e5;
            color: #fff;
            border: none;
            padding: 0.5rem 1rem;
            cursor: pointer;
            border-radius: 4px;
        }
        .btn:hover {
            background: #1565c0;
        }
    </style>
</head>
<body>
    <div class="sidebar">
        <button data-section="generate-keys">Generate Keys</button>
        <button data-section="encrypt">Encrypt</button>
        <button data-section="decrypt">Decrypt</button>
        <button data-section="about">About</button>
    </div>
    <div class="content">
        <section id="generate-keys" class="active">
            <h2>Generate Keys</h2>
            <input type="text" id="name" placeholder="Name">
            <input type="email" id="email" placeholder="Email">
            <input type="password" id="passphrase" placeholder="Passphrase">
            <button class="btn" onclick="generateKeys()">Generate</button>
            <textarea id="privateKey" placeholder="Private Key" readonly></textarea>
            <textarea id="publicKey" placeholder="Public Key" readonly></textarea>
        </section>
        <section id="encrypt">
            <h2>Encrypt Message</h2>
            <textarea id="publicKeyEncrypt" placeholder="Recipient's Public Key"></textarea>
            <textarea id="plainText" placeholder="Message"></textarea>
            <button class="btn" onclick="encryptMessage()">Encrypt</button>
            <textarea id="cipherText" placeholder="Encrypted Message" readonly></textarea>
        </section>
        <section id="decrypt">
            <h2>Decrypt Message</h2>
            <textarea id="privateKeyDecrypt" placeholder="Your Private Key"></textarea>
            <input type="password" id="passphraseDecrypt" placeholder="Passphrase">
            <textarea id="cipherTextDecrypt" placeholder="Encrypted Message"></textarea>
            <button class="btn" onclick="decryptMessage()">Decrypt</button>
            <textarea id="plainTextDecrypt" placeholder="Decrypted Message" readonly></textarea>
        </section>
        <section id="about">
            <h2>About OnlinePGP</h2>
            <p>OnlinePGP is a simple and secure tool for generating PGP keys, encrypting messages, and decrypting encrypted content. Powered by OpenPGP.js, this app ensures secure communication by following modern cryptographic standards.</p>
            <p><strong>How to use:</strong></p>
            <ul>
                <li>Generate your public and private keys in the "Generate Keys" section.</li>
                <li>Use the "Encrypt" section to secure a message with the recipient's public key.</li>
                <li>Decrypt messages in the "Decrypt" section using your private key and passphrase.</li>
            </ul>
        </section>
    </div>
    <script>
        document.querySelectorAll('.sidebar button').forEach(button => {
            button.addEventListener('click', () => {
                document.querySelectorAll('section').forEach(section => section.classList.remove('active'));
                document.getElementById(button.dataset.section).classList.add('active');
            });
        });

        async function generateKeys() {
            try {
                const name = document.getElementById('name').value;
                const email = document.getElementById('email').value;
                const passphrase = document.getElementById('passphrase').value;

                const { privateKey, publicKey } = await openpgp.generateKey({
                    type: 'ecc',
                    curve: 'curve25519',
                    userIDs: [{ name, email }],
                    passphrase,
                });

                document.getElementById('privateKey').value = privateKey;
                document.getElementById('publicKey').value = publicKey;
                alert('Keys generated successfully!');
            } catch (error) {
                alert('Failed to generate keys: ' + error.message);
            }
        }

        async function encryptMessage() {
            try {
                const publicKeyArmored = document.getElementById('publicKeyEncrypt').value;
                const message = document.getElementById('plainText').value;

                const publicKey = await openpgp.readKey({ armoredKey: publicKeyArmored });
                const encrypted = await openpgp.encrypt({
                    message: await openpgp.createMessage({ text: message }),
                    encryptionKeys: publicKey,
                });

                document.getElementById('cipherText').value = encrypted;
                alert('Message encrypted successfully!');
            } catch (error) {
                alert('Failed to encrypt message: ' + error.message);
            }
        }

        async function decryptMessage() {
            try {
                const privateKeyArmored = document.getElementById('privateKeyDecrypt').value;
                const passphrase = document.getElementById('passphraseDecrypt').value;
                const encryptedMessage = document.getElementById('cipherTextDecrypt').value;

                const privateKey = await openpgp.decryptKey({
                    privateKey: await openpgp.readPrivateKey({ armoredKey: privateKeyArmored }),
                    passphrase,
                });
                const message = await openpgp.readMessage({ armoredMessage: encryptedMessage });

                const { data: decrypted } = await openpgp.decrypt({
                    message,
                    decryptionKeys: privateKey,
                });

                document.getElementById('plainTextDecrypt').value = decrypted;
                alert('Message decrypted successfully!');
            } catch (error) {
                alert('Failed to decrypt message: ' + error.message);
            }
        }
    </script>
</body>
</html>
