<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OnlinePGP - PGP Encryption Toolkit</title>
    <link rel="shortcut icon" type="png" href="favicon.png"/>
    <style>
        body {
            font-family: 'Arial', sans-serif;
            background: #0e1228;
            color: #e9e9f0;
            display: flex;
            min-height: 100vh;
        }
        .sidebar {
            background: #1a1a2e;
            color: #fff;
            padding: 20px;
            width: 200px;
            height: 100vh;
            display: flex;
            flex-direction: column;
        }
        .sidebar h2 {
            margin-bottom: 20px;
        }
        .sidebar button {
            background: none;
            color: #e9e9f0;
            border: none;
            padding: 10px;
            margin: 5px 0;
            text-align: left;
            cursor: pointer;
        }
        .sidebar button:hover {
            background: #16213e;
        }
        .container {
            flex-grow: 1;
            padding: 20px;
        }
        .section {
            display: none;
        }
        .section.active {
            display: block;
        }
        h1, h2 {
            text-align: center;
        }
        .input-group {
            margin-bottom: 15px;
        }
        input, textarea {
            width: 100%;
            padding: 10px;
            background: #252a41;
            border: none;
            border-radius: 8px;
            color: #e9e9f0;
            font-size: 1rem;
        }
        button {
            width: 100%;
            padding: 12px;
            background: #0f3460;
            color: #fff;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1rem;
        }
        button:hover {
            background: #16213e;
        }
        .result-area {
            margin-top: 15px;
        }
    </style>
</head>
<body>
    <div class="sidebar">
        <h2>Navigation</h2>
        <button class="nav-link" data-section="generate-keys">Generate PGP Keys</button>
        <button class="nav-link" data-section="encrypt">Encrypt Message</button>
        <button class="nav-link" data-section="decrypt">Decrypt Message</button>
    </div>

    <div class="container">
        <header>
            <h1>OnlinePGP PGP Toolkit</h1>
        </header>

        <section id="generate-keys" class="section">
            <h2>Generate PGP Keys</h2>
            <div class="input-group">
                <label for="name">Full Name</label>
                <input type="text" id="name" placeholder="Enter your full name">
            </div>
            <div class="input-group">
                <label for="email">Email Address</label>
                <input type="email" id="email" placeholder="Enter your email">
            </div>
            <div class="input-group">
                <label for="passphrase">Passphrase</label>
                <input type="password" id="passphrase" placeholder="Create a strong passphrase">
            </div>
            <button onclick="generateKeys()">Generate Keys</button>
            <div class="result-area">
                <h3>Private Key</h3>
                <textarea id="privateKey" readonly></textarea>
            </div>
            <div class="result-area">
                <h3>Public Key</h3>
                <textarea id="publicKey" readonly></textarea>
            </div>
        </section>

        <section id="encrypt" class="section">
            <h2>Encrypt Message</h2>
            <div class="input-group">
                <label for="publicKeyEncrypt">Recipient's Public Key</label>
                <textarea id="publicKeyEncrypt"></textarea>
            </div>
            <div class="input-group">
                <label for="plainText">Message to Encrypt</label>
                <textarea id="plainText"></textarea>
            </div>
            <button onclick="encryptMessage()">Encrypt Message</button>
            <div class="result-area">
                <h3>Encrypted Message</h3>
                <textarea id="cipherText" readonly></textarea>
            </div>
        </section>

        <section id="decrypt" class="section">
            <h2>Decrypt Message</h2>
            <div class="input-group">
                <label for="privateKeyDecrypt">Your Private Key</label>
                <textarea id="privateKeyDecrypt"></textarea>
            </div>
            <div class="input-group">
                <label for="passphraseDecrypt">Passphrase</label>
                <input type="password" id="passphraseDecrypt" placeholder="Enter your passphrase">
            </div>
            <div class="input-group">
                <label for="cipherTextDecrypt">Encrypted Message</label>
                <textarea id="cipherTextDecrypt"></textarea>
            </div>
            <button onclick="decryptMessage()">Decrypt Message</button>
            <div class="result-area">
                <h3>Decrypted Message</h3>
                <textarea id="plainTextDecrypt" readonly></textarea>
            </div>
        </section>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/openpgp/4.0.1/openpgp.min.js"></script>
    <script>
        document.querySelectorAll('.nav-link').forEach(link => {
            link.addEventListener('click', (e) => {
                const sectionId = e.target.dataset.section;
                showSection(sectionId);
            });
        });

        function showSection(sectionId) {
            document.querySelectorAll('.section').forEach(section => section.classList.remove('active'));
            document.getElementById(sectionId).classList.add('active');
        }

        showSection('generate-keys');

        async function generateKeys() {
            const name = document.getElementById('name').value.trim();
            const email = document.getElementById('email').value.trim();
            const passphrase = document.getElementById('passphrase').value;

            if (!name || !email || !passphrase) {
                alert('Please fill in all fields');
                return;
            }

            try {
                const { privateKeyArmored, publicKeyArmored } = await openpgp.generateKey({
                    userIds: [{ name, email }],
                    rsaBits: 4096,
                    passphrase
                });

                document.getElementById('privateKey').value = privateKeyArmored;
                document.getElementById('publicKey').value = publicKeyArmored;
                alert('Keys generated successfully!');
            } catch (error) {
                console.error('Key generation error:', error);
                alert('Failed to generate keys');
            }
        }

        async function encryptMessage() {
            const publicKeyArmored = document.getElementById('publicKeyEncrypt').value.trim();
            const plainText = document.getElementById('plainText').value.trim();

            if (!publicKeyArmored || !plainText) {
                alert('Please provide both public key and message');
                return;
            }

            try {
                const publicKey = await openpgp.key.readArmored(publicKeyArmored);
                const message = openpgp.message.fromText(plainText);
                const encrypted = await openpgp.encrypt({
                    message,
                    publicKeys: publicKey.keys
                });

                document.getElementById('cipherText').value = encrypted;
                alert('Message encrypted successfully!');
            } catch (error) {
                console.error('Encryption error:', error);
                alert('Failed to encrypt message');
            }
        }

        async function decryptMessage() {
            const privateKeyArmored = document.getElementById('privateKeyDecrypt').value.trim();
            const passphrase = document.getElementById('passphraseDecrypt').value;
            const encryptedMessage = document.getElementById('cipherTextDecrypt').value.trim();

            if (!privateKeyArmored || !passphrase || !encryptedMessage) {
                alert('Please provide private key, passphrase, and encrypted message');
                return;
            }

            try {
                const privateKey = (await openpgp.key.readArmored(privateKeyArmored)).keys[0];
                await privateKey.decrypt(passphrase);

                const message = await openpgp.message.readArmored(encryptedMessage);
                const decrypted = await openpgp.decrypt({
                    message,
                    privateKeys: [privateKey]
                });

                document.getElementById('plainTextDecrypt').value = decrypted.data;
                alert('Message decrypted successfully!');
            } catch (error) {
                console.error('Decryption error:', error);
                alert('Failed to decrypt message');
            }
        }
    </script>
</body>
</html>
